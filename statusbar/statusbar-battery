#!/bin/sh

capacity_combined=0
battery_count=0

for battery in /sys/class/power_supply/BAT?; do
	case "$(cat $battery/status)" in
		"Full") status="ğŸ”‹" ;;
		"Charging") status="ğŸ”Œ" ;;
		"Discharging") status="ğŸ”‹" ;;
		"Not charging") status="ğŸ”‹" ;;
		"Unknown") status="ğŸ”‹" ;;
	esac

	capacity="$(cat "$battery/capacity")"

	if [ "$status" = "ïƒ§" ]; then
		printf "%s%s" "$capacity%$status"
	else	
		printf "%s%s" "$capacity%$status"
	fi

	capacity_combined=$(echo "$capacity + $capacity_combined" | bc)
	battery_count=$(echo "$battery_count + 1" | bc)
done 

capacity_combined=$(echo "$capacity_combined / $battery_count" | bc)
if [ $capacity_combined -lt 20 ]; then
	echo "âš "
fi
